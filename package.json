{
  "name": "portal",
  "version": "0.1.0",
  "private": true,
  "workspaces": [
    "frontend",
    "worker",
    "packages/shared",
    "notification",
    "payment"
  ],
  "scripts": {
    "clean": "rimraf packages/shared/dist worker/dist notification/dist payment/dist frontend/dist",
    
    "shared:build": "cd packages/shared && pnpm run build",
    "shared:dev": "cd packages/shared && pnpm run dev",
    "shared:clean": "rimraf packages/shared/dist",

    "worker:dev": "cd worker && pnpm run dev",
    "worker:build": "cd worker && pnpm run build",
    "worker:clean": "rimraf worker/dist",

    "notification:dev": "cd notification && pnpm run dev",
    "notification:build": "cd notification && pnpm run build",
    "notification:clean": "rimraf notification/dist",

    "payment:dev": "cd payment && pnpm run dev",
    "payment:build": "cd payment && pnpm run build",
    "payment:clean": "rimraf payment/dist",

    "frontend:dev": "cd frontend && pnpm run dev",
    "frontend:build": "cd frontend && pnpm run build",
    "frontend:clean": "rimraf frontend/dist",

    "dev": "concurrently \"pnpm run shared:dev\" \"pnpm run worker:dev\" \"pnpm run frontend:dev\" \"pnpm run notification:dev\" \"pnpm run payment:dev\"",

    "build:shared": "pnpm run shared:clean && pnpm run shared:build",
    "build:workers": "concurrently \"pnpm run worker:build\" \"pnpm run notification:build\" \"pnpm run payment:build\"",
    "build:frontend": "pnpm run frontend:build || echo 'Frontend build failed but continuing'",
    
    "build": "pnpm run build:shared && pnpm run build:workers && pnpm run build:frontend",

    "typecheck": "concurrently \"cd packages/shared && tsc --noEmit\" \"cd worker && tsc --noEmit\" \"cd notification && tsc --noEmit\" \"cd payment && tsc --noEmit\" \"cd frontend && tsc --noEmit\"",

    "deploy:worker": "cd worker && pnpm run deploy",
    "deploy:frontend": "cd frontend && pnpm run build && pnpm exec wrangler pages deploy dist",
    "deploy:notification": "cd notification && pnpm run deploy",
    "deploy:payment": "cd payment && pnpm run deploy",

    "migrate": "cd worker && pnpm exec wrangler d1 migrations apply gutter_db --env production",

    "deploy": "pnpm install && pnpm run build && pnpm run migrate && concurrently \"pnpm run deploy:worker\" \"pnpm run deploy:notification\" \"pnpm run deploy:payment\" && pnpm run deploy:frontend",

    "test": "cd worker && pnpm run test"
  },
  "devDependencies": {
    "concurrently": "^8.2.0",
    "rimraf": "^5.0.10"
  },
  "engines": {
    "node": ">=18.0.0"
  }
}
